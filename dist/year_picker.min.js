class PortableYearPicker{constructor(e={}){this.currentInput=null,this.currentDecadeStart=null,this.minYear=1900,this.maxYear=2100,this.isVisible=!1,this.dropdownId=e.dropdownId||"year-picker-dropdown",this.createDropdownIfNeeded(),this.dropdown=document.getElementById(this.dropdownId),this.rangeSpan=this.dropdown.querySelector(".year-picker-range"),this.grid=this.dropdown.querySelector(".year-picker-grid"),this.prevBtn=this.dropdown.querySelector(".year-picker-nav.prev"),this.nextBtn=this.dropdown.querySelector(".year-picker-nav.next"),this.init()}createDropdownIfNeeded(){if(!document.getElementById(this.dropdownId)){const e=document.createElement("div");e.id=this.dropdownId,e.className="year-picker-dropdown",e.innerHTML='\n                <div class="year-picker-header">\n                    <button class="year-picker-nav prev" type="button">&lt;</button>\n                    <span class="year-picker-range"></span>\n                    <button class="year-picker-nav next" type="button">&gt;</button>\n                </div>\n                <div class="year-picker-grid"></div>\n            ',document.body.appendChild(e)}}init(){this.bindGlobalEvents(),this.bindNavigationEvents(),this.initializeInputs()}initializeInputs(){document.querySelectorAll(".year-picker-input").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),this.showPicker(e)}),e.setAttribute("readonly","readonly")})}bindGlobalEvents(){document.addEventListener("click",e=>{!this.isVisible||this.dropdown.contains(e.target)||e.target.classList.contains("year-picker-input")||this.hidePicker()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.isVisible&&this.hidePicker()})}bindNavigationEvents(){this.prevBtn.addEventListener("click",e=>{e.stopPropagation(),this.navigateDecade(-12)}),this.nextBtn.addEventListener("click",e=>{e.stopPropagation(),this.navigateDecade(12)})}showPicker(e){this.currentInput=e,this.minYear=parseInt(e.dataset.minYear)||1900,this.maxYear=parseInt(e.dataset.maxYear)||2100;const t=e.value,r=t?parseInt(t):(new Date).getFullYear();this.currentDecadeStart=12*Math.floor(r/12),this.positionDropdown(e),this.renderYears(r),this.dropdown.style.display="block",this.isVisible=!0}hidePicker(){this.dropdown.style.display="none",this.isVisible=!1,this.currentInput=null}positionDropdown(e){const t=e.getBoundingClientRect(),r=window.pageYOffset||document.documentElement.scrollTop,i=window.pageXOffset||document.documentElement.scrollLeft;this.dropdown.style.position="absolute",this.dropdown.style.left=t.left+i+"px",this.dropdown.style.top=t.bottom+r+5+"px",this.dropdown.style.zIndex="1000"}navigateDecade(e){this.currentDecadeStart+=e,this.currentDecadeStart<this.minYear-11&&(this.currentDecadeStart=12*Math.floor(this.minYear/12)),this.currentDecadeStart>this.maxYear&&(this.currentDecadeStart=12*Math.floor(this.maxYear/12));const t=this.currentInput.value?parseInt(this.currentInput.value):null;this.renderYears(t)}renderYears(e=null){this.grid.innerHTML="";const t=this.currentDecadeStart+11,r=Math.max(this.currentDecadeStart,this.minYear),i=Math.min(t,this.maxYear);this.rangeSpan.textContent=`${r}-${i}`,this.prevBtn.disabled=this.currentDecadeStart<=12*Math.floor(this.minYear/12),this.nextBtn.disabled=this.currentDecadeStart>=12*Math.floor(this.maxYear/12);for(let r=this.currentDecadeStart;r<=t;r++){const t=document.createElement("div");t.className="year-item",t.textContent=r,r===e&&t.classList.add("selected"),r<this.minYear||r>this.maxYear?t.classList.add("disabled"):(t.classList.add("selectable"),t.addEventListener("click",()=>{this.selectYear(r)})),this.grid.appendChild(t)}}selectYear(e){if(this.currentInput){this.currentInput.value=e;const t=new Event("change",{bubbles:!0});this.currentInput.dispatchEvent(t)}this.hidePicker()}}document.addEventListener("DOMContentLoaded",function(){window.yearPicker||(window.yearPicker=new PortableYearPicker)}),window.initYearPicker=function(e,t={}){const r=document.getElementById(e);return r?(window.yearPicker||(window.yearPicker=new PortableYearPicker),r.classList.add("year-picker-input"),r.setAttribute("readonly","readonly"),t.minYear&&(r.dataset.minYear=t.minYear),t.maxYear&&(r.dataset.maxYear=t.maxYear),t.defaultYear&&(r.value=t.defaultYear),r.removeEventListener("click",r._yearPickerHandler),r._yearPickerHandler=function(e){e.preventDefault(),e.stopPropagation(),window.yearPicker.showPicker(r)},r.addEventListener("click",r._yearPickerHandler),window.yearPicker):(console.warn(`Year picker: Field with ID '${e}' not found`),null)},window.addYearPicker=function(e,t={}){const r=document.querySelectorAll(e),i=[];return r.forEach(e=>{if(e.id)i.push(window.initYearPicker(e.id,t));else{const r="year-picker-"+Math.random().toString(36).substr(2,9);e.id=r,i.push(window.initYearPicker(r,t))}}),i},window.removeYearPicker=function(e){const t=document.getElementById(e);t&&t._yearPickerHandler&&(t.removeEventListener("click",t._yearPickerHandler),t.classList.remove("year-picker-input"),t.removeAttribute("readonly"),delete t._yearPickerHandler)},window.updateYearPicker=function(e,t={}){const r=document.getElementById(e);r&&(void 0!==t.minYear&&(r.dataset.minYear=t.minYear),void 0!==t.maxYear&&(r.dataset.maxYear=t.maxYear),void 0!==t.value&&(r.value=t.value))};